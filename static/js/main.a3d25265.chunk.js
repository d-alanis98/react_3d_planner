(this["webpackJsonpreact-3d"]=this["webpackJsonpreact-3d"]||[]).push([[0],{100:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(23),r=n.n(o),c=n(20),s=n(17),l=n(41),d=n(2),u={editorType:"BIDIMENSIONAL EDITOR",editorWidth:0,editorHeight:0},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"SET_EDITOR_TYPE":return Object(d.a)(Object(d.a)({},e),{},{editorType:a});case"SET_EDITOR_WIDTH":return Object(d.a)(Object(d.a)({},e),{},{editorWidth:a});case"SET_EDITOR_HEIGHT":return Object(d.a)(Object(d.a)({},e),{},{editorHeight:a});default:return e}},h=function(e){return function(t,n){t({type:"SET_EDITOR_TYPE",payload:e})}},E=function(e){return function(t,n){t({type:"SET_EDITOR_WIDTH",payload:e})}},b=function(e){return function(t,n){t({type:"SET_EDITOR_HEIGHT",payload:e})}},f=n(14),O=n(8),g=function e(){Object(O.a)(this,e)};g.makeRequest=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length,o=new Array(i>4?i-4:0),r=4;r<i;r++)o[r-4]=arguments[r];fetch(e,t).then((function(e){throw 200===e.status&&e.json().then((function(e){n&&"function"===typeof n&&n.apply(void 0,[e].concat(o))})),new Error("".concat(e.status,"|").concat(e.statusText))})).catch((function(e){var t=e.message.split("|"),n=Object(f.a)(t,2),i=n[0],r=n[1];a&&"function"===typeof a&&a.apply(void 0,[i,r].concat(o))}))};var p=function e(){Object(O.a)(this,e)};p.CLOSET_PROJECT="CLOSET";var j={name:"",type:p.KITCHEN_PROJECT="KITCHEN",scene:{},objects:[],description:""},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"SET_PROJECT_NAME":return Object(d.a)(Object(d.a)({},e),{},{name:a});case"SET_PROJECT_TYPE":return Object(d.a)(Object(d.a)({},e),{},{type:a});case"SET_PROJECT_SCENE":return Object(d.a)(Object(d.a)({},e),{},{scene:a});case"SET_PROJECT_OBJECTS":return Object(d.a)(Object(d.a)({},e),{},{objects:a});case"SET_PROJECT_DESCRIPTION":return Object(d.a)(Object(d.a)({},e),{},{description:a});default:return e}},T=function(e){console.log(e)},y=function(e,t){console.log("[".concat(e,"]: ").concat(t))},N=function(e){return function(t,n){t({type:"SET_PROJECT_NAME",payload:e})}},I=function(e,t){return function(n,a){var i=Object(d.a)({},a().project).scene,o=i["2d"],r=Object(d.a)(Object(d.a)({},o),{},{roomWidth:e,roomHeight:t});n({type:"SET_PROJECT_SCENE",payload:Object(d.a)(Object(d.a)({},i),{},{"2d":r})})}},D=function(e,t){return function(n,a){var i=Object(d.a)({},a().project).scene,o=i["2d"],r=Object(d.a)(Object(d.a)({},o),{},{sceneWidth:e,sceneHeight:t});n({type:"SET_PROJECT_SCENE",payload:Object(d.a)(Object(d.a)({},i),{},{"2d":r})})}},C=function(e,t){return function(n,a){var i=Object(d.a)({},a().project).scene,o=i["3d"],r=Object(d.a)(Object(d.a)({},o),{},{sceneWidth:e,sceneHeight:t});n({type:"SET_PROJECT_SCENE",payload:Object(d.a)(Object(d.a)({},i),{},{"3d":r})})}},R=function(e){return function(t,n){t({type:"SET_PROJECT_TYPE",payload:e})}},x=function(e){return function(t,n){t({type:"SET_PROJECT_OBJECTS",payload:e})}},S=function(e){return function(t,n){t({type:"SET_PROJECT_DESCRIPTION",payload:e})}},_=function(e){return function(t,n){var a=Object(d.a)({},n().project).objects.concat(e);x(a)(t,n)}},P=function(e){return function(t,n){var a=Object(d.a)({},n().project).objects.map((function(t){return t.id===e.id?e:t}));x(a)(t,n)}},A=function(e){return function(t,n){var a=Object(d.a)({},n().project).objects.filter((function(t){return t.id!=e.id}));x(a)(t,n)}},k=function(){return function(e,t){var n=Object(d.a)({},t()).project;g.makeRequest("/save_project_progress",{method:"POST",body:n},T,y)}},w=("".concat("https://dev.qpr.mx/api","/familias"),{objects:[],fetching:!1}),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"GET_OBJECTS":return Object(d.a)(Object(d.a)({},e),{},{fetching:!0});case"GET_OBJECTS_ERROR":return Object(d.a)(Object(d.a)({},e),{},{error:a,fetching:!1});case"GET_OBJECTS_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{objects:a,fetching:!1});default:return e}},H=Object(s.c)({editor:m,project:v,objects:W}),L=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,F=function(){return Object(s.e)(H,L(Object(s.a)(l.a)))},U=n(24),M=n.n(U),B=n(11),G=function(e){var t=e.children,n=e.className,a=Object(B.a)(e,["children","className"]);return i.a.createElement("div",Object.assign({className:"d-flex ".concat(n||"")},a),t)},X=function(e){var t=e.children,n=e.className;return i.a.createElement(G,{className:"flex-row ".concat(n||"")},t)},z=function(e){var t=e.children,n=e.className,a=Object(B.a)(e,["children","className"]);return i.a.createElement(G,Object.assign({className:"flex-column ".concat(n||"")},a),t)},V=n(19),Z=function(e){var t=e.id,n=e.icon,a=e.onClick,o=e.className,r=e.labelText,c=Object(B.a)(e,["id","icon","onClick","className","labelText"]);return i.a.createElement("label",Object.assign({id:t,onClick:a,className:o},c),i.a.createElement(X,{className:"align-items-center"},i.a.createElement(V.a,{icon:n,className:"mr-2"}),r))},K=function(e){return Object(c.b)((function(e,t){return Object(d.a)({editor:e.editor},t)}),{setEditorTypeAction:h,setEditorWidthAction:E,setEditorHeightAction:b})((function(t){var n=t.editor,a=t.setEditorTypeAction,o=t.setEditorWidthAction,r=t.setEditorHeightAction,c=Object(B.a)(t,["editor","setEditorTypeAction","setEditorWidthAction","setEditorHeightAction"]);return i.a.createElement(e,Object.assign({editorState:n,setEditorType:a,setEditorWidth:o,setEditorHeight:r},c))}))},q=n(4),Y=n(3),J=function(e){var t=e.projectName,n=e.handleSettingChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement(Z,{icon:q.e,labelText:"Nombre del proyecto",className:"h6 text-muted"}),i.a.createElement("input",{type:"text",name:"projectName",value:t,onChange:n,className:"form-control rounded-lg",placeholder:"Nombre del proyecto"}))},Q=function(e){var t=e.icon,n=e.type,a=e.onClick,o=e.className,r=e.buttonText,c=Object(B.a)(e,["icon","type","onClick","className","buttonText"]);return i.a.createElement("button",Object.assign({onClick:a,className:"btn btn-".concat(n," ").concat(o||"")},c),i.a.createElement(X,{className:"align-items-center"},i.a.createElement(V.a,{icon:t,className:"mr-2"}),r))},$=function(e){var t=e.children,n=e.className,a=Object(B.a)(e,["children","className"]);return i.a.createElement("div",Object.assign({className:"row m-0 ".concat(n||"")},a),t)},ee=function(e){var t=e.children,n=e.className,a=e.fixedSize,o=e.smBreakpoint,r=e.mdBreakpoint,c=e.lgBreakpoint,s=e.xlBreakpoint;return i.a.createElement("div",{className:"".concat(function(){if(a)return"col-".concat(a);var e="";return s&&(e+="col-xl-".concat(s," ")),c&&(e+="col-lg-".concat(c," ")),r&&(e+="col-md-".concat(r," ")),o&&(e+="col-sm-".concat(o," ")),e}()," ").concat(n||"")},t)},te=function(e){var t=e.icon,n=e.name,a=e.value,o=e.labelText,r=e.handleInputChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement(Z,{icon:t,labelText:o,className:"h6 text-muted"}),i.a.createElement(X,{className:"align-items-center justify-content-center"},i.a.createElement("input",{type:"number",name:n,onChange:r,className:"form-control",defaultValue:a}),i.a.createElement("span",{className:"ml-2"},"metros")))},ne=function(e){var t=e.projectEditorWidth,n=e.projectEditorHeight,a=e.handleSettingChange;return i.a.createElement($,{className:"text-center"},i.a.createElement(ee,{mdBreakpoint:"6",smBreakpoint:"12"},i.a.createElement(te,{icon:q.c,name:"editorWidth",value:t,labelText:"Ancho de la habitaci\xf3n",handleInputChange:a})),i.a.createElement(ee,{mdBreakpoint:"6",smBreakpoint:"12"},i.a.createElement(te,{icon:q.d,name:"editorHeight",value:n,labelText:"Alto de la habitaci\xf3n",handleInputChange:a})))},ae=function(e){var t=e.projectDescription,n=e.handleSettingChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement(Z,{icon:q.a,labelText:"Descripci\xf3n del proyecto",className:"h6 text-muted"}),i.a.createElement("textarea",{rows:"5",name:"projectDescription",value:t,onChange:n,className:"form-control"}))},ie=function(e){return Object(c.b)((function(e,t){return Object(d.a)({project:e.project},t)}),{saveProjectAction:k,setProjectNameAction:N,setProjectTypeAction:R,setProjectObjectsAction:x,addObjectToProjectAction:_,updateProjectObjectAction:P,set2DRoomDimensionsAction:I,set2DSceneDimensionsAction:D,set3DSceneDimensionsAction:C,setProjectDescriptionAction:S,removeObjectFromProjectAction:A})((function(t){var n=t.project,a=(t.saveProjectAction,t.setProjectNameAction),o=t.setProjectTypeAction,r=(t.setProjectObjectsAction,t.addObjectToProjectAction),c=t.updateProjectObjectAction,s=t.set2DRoomDimensionsAction,l=t.set2DSceneDimensionsAction,d=t.set3DSceneDimensionsAction,u=t.setProjectDescriptionAction,m=t.removeObjectFromProjectAction,h=Object(B.a)(t,["project","saveProjectAction","setProjectNameAction","setProjectTypeAction","setProjectObjectsAction","addObjectToProjectAction","updateProjectObjectAction","set2DRoomDimensionsAction","set2DSceneDimensionsAction","set3DSceneDimensionsAction","setProjectDescriptionAction","removeObjectFromProjectAction"]);return i.a.createElement(e,Object.assign({project:n,addObject:r,updateObject:c,removeObject:m,setProjectName:a,setProjectType:o,setProjectObjects:a,set2DRoomDimensions:s,set2DSceneDimensions:l,set3DSceneDimensions:d,setProjectDescription:u},h))}))},oe=function(e){var t=e.unsavedChanges,n=e.fieldsValidated,a=e.saveProjectChanges;return t?i.a.createElement(X,{className:"justify-content-center"},i.a.createElement(Q,{icon:q.v,onClick:a,disabled:!n,className:"btn btn-success",buttonText:"Guardar cambios"})):null},re=function(e){var t=e.children,n=e.className,a=Object(B.a)(e,["children","className"]);return i.a.createElement("div",Object.assign({className:"container ".concat(n||"")},a),t)},ce=function(e){var t=e.projectType,n=e.handleSettingChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement(Z,{icon:q.u,labelText:"Tipo de proyecto",className:"h6 text-muted"}),i.a.createElement("select",{name:"projectType",onChange:n,className:"form-control",defaultValue:t},i.a.createElement("option",{value:p.CLOSET_PROJECT},"Closet"),i.a.createElement("option",{value:p.KITCHEN_PROJECT},"Cocina")))},se=ie((function(e){var t=e.project,n=t.name,o=t.type,r=t.description,c=e.editorState,s=c.editorHeight,l=c.editorWidth,u=e.setProjectName,m=e.setProjectType,h=e.setEditorWidth,E=e.setEditorHeight,b=e.set3DSceneDimensions,O=e.setProjectDescription,g={projectName:n,projectType:o,editorWidth:l,editorHeight:s,projectDescription:r},p=Object(a.useState)(!1),j=Object(f.a)(p,2),v=j[0],T=j[1],y=Object(a.useState)(!1),N=Object(f.a)(y,2),I=N[0],D=N[1],C=Object(a.useState)(g),R=Object(f.a)(C,2),x=R[0],S=R[1],_=x.projectName,P=x.projectType,A=x.editorWidth,k=x.editorHeight,w=x.projectDescription;Object(a.useEffect)((function(){D(!!(_&&w&&A&&k))}),[x]);var W=function(e){var t=e.target,n=t.name,a=t.value;"editorWidth"!==n&&"editorHeight"!==n||(a=Number(a)),S(Object(d.a)(Object(d.a)({},x),{},Object(Y.a)({},n,a))),T(!0)};return i.a.createElement(re,{className:"mt-3 py-3"},i.a.createElement(Z,{icon:q.k,labelText:"Ajustes del proyecto",className:"h4 text-muted"}),i.a.createElement("hr",null),i.a.createElement(ce,{projectType:P,handleSettingChange:W}),i.a.createElement(J,{projectName:_,handleSettingChange:W}),i.a.createElement(ae,{projectDescription:w,handleSettingChange:W}),i.a.createElement("hr",null),i.a.createElement(Z,{icon:q.l,labelText:"Ajustes del editor",className:"h5 text-muted"}),i.a.createElement(ne,{projectEditorWidth:A,projectEditorHeight:k,handleSettingChange:W}),i.a.createElement(oe,{unsavedChanges:v,fieldsValidated:I,saveProjectChanges:function(e){e.preventDefault(),T(!1),u(_),m(P),h(A),E(k),b(A,k),O(w)}}))})),le=K(se),de=(n(58),function(e){var t=e.height,n=e.children,a=e.className,o=Object(B.a)(e,["height","children","className"]);return i.a.createElement("div",Object.assign({className:"h-".concat(t," ").concat(a||"")},o),n)}),ue=n(15),me=n(16),he=n.n(me),Ee=function e(){Object(O.a)(this,e)};Ee.addPlaneZoomEventListener=function(e){e.on("wheel",(function(t){t.evt.preventDefault();var n=e.scaleX(),a=e.getPointerPosition(),i=(a.x-e.x())/n,o=(a.y-e.y())/n,r=t.evt.deltaY>0?1.1*n:n/1.1;e.scale({x:r,y:r});var c={x:a.x-i*r,y:a.y-o*r};e.position(c),e.batchDraw()}))};var be=function(){function e(t,n,a,i){Object(O.a)(this,e),this.roomWidth=t,this.roomHeight=n,this.containerWidth=a,this.containerHeight=i,this.scale=1}return Object(ue.a)(e,[{key:"setScale",value:function(e){this.scale=e}},{key:"getScale",value:function(){return this.scale}},{key:"setRoomDimensionsInPixels",value:function(e,t,n,a){this.widthInPixels=t-e,this.heightInPixels=a-n}},{key:"getRoomDimensionsInPixels",value:function(){return{width:this.widthInPixels,height:this.heightInPixels}}},{key:"calculate",value:function(){var t=this.roomWidth,n=this.roomHeight,a=this.containerWidth,i=this.containerHeight,o=e.PLANE_PADDING,r=o/2,c=a-o/2,s=o/2,l=i-o/2,d=n*((a-o)/t)+o,u=t*((i-o)/n)+o;if(i<d){var m=d/i;this.setScale(m);var h=(c/=m)-r;c=(r=(a-h)/2)+h}if(a<u){var E=u/a;this.setScale(E);var b=(l/=E)-s;l=(s=(i-b)/2)+b}return this.setRoomDimensionsInPixels(r,c,s,l),{initialX:r,finalX:c,initialY:s,finalY:l}}}]),e}();be.PLANE_PADDING=20;var fe=function e(){Object(O.a)(this,e)};fe.DRAG_END_EVENT="dragend",fe.RIGHT_CLICK_EVENT="contextmenu",fe.addEventListener=function(e,t,n){e.on(t,n)},fe.addRightClickListener=function(e,t){(0,fe.addEventListener)(e,fe.RIGHT_CLICK_EVENT,(function(e){return e.evt.preventDefault(),t&&"function"===typeof t&&t(e),!1}))},fe.addDragEndListener=function(e,t){(0,fe.addEventListener)(e,fe.DRAG_END_EVENT,t)},fe.addModelBasicEventListeners=function(e,t,n){var a=fe.addRightClickListener;(0,fe.addDragEndListener)(e,t),a(e,n)};var Oe=function e(){Object(O.a)(this,e)};Oe.boundDetection=function(e,t,n,a){var i=e.containerWidth,o=e.containerHeight,r=e.roomDimensionInPixels,c=r.width,s=r.height,l=(i-c)/2,d=(o-s)/2,u=t/2,m=n/2;return{x:a.x-u<=l?l+u:a.x+u>=c+l?c-u+l:a.x,y:a.y-m<=d?d+m:a.y+m>=s+d?s-m+d:a.y}};var ge,pe,je=function e(){Object(O.a)(this,e)};je.calculate=function(e,t,n){var a=e.roomWidth,i=e.roomHeight,o=e.roomDimensionInPixels;return{width:t*o.width/a,height:n*o.height/i}};var ve="TABLE",Te=(ge={},Object(Y.a)(ge,"KIOSK",{uri:"/assets/models/3D/kiosk/kiosk.glb",thumbnail:"/assets/models/3D/kiosk/thumbnail.png"}),Object(Y.a)(ge,ve,{uri:"/assets/models/3D/table/table.glb",thumbnail:"/assets/models/3D/table/thumbnail.png"}),Object(Y.a)(ge,"BOARD",{uri:"/assets/models/3D/board/board.glb",thumbnail:"/assets/models/3D/board/thumbnail.png"}),Object(Y.a)(ge,"FURNITURE",{uri:"/assets/models/3D/furniture/furniture.glb",thumbnail:"/assets/models/3D/furniture/thumbnail.png"}),ge),ye=Object(Y.a)({},"FURNITURE",(pe={},Object(Y.a)(pe,"TOP",{uri:"/assets/models/2D/furniture/furniture_top.svg",thumbnail:"/assets/models/3D/furniture/thumbnail.png"}),Object(Y.a)(pe,"FRONT",{uri:"/assets/models/2D/furniture/furniture_front.svg",thumbnail:"/assets/models/3D/furniture/thumbnail.png"}),Object(Y.a)(pe,"FRONT_LEFT",{uri:"/assets/models/2D/furniture/furniture_front.svg",thumbnail:"/assets/models/3D/furniture/thumbnail.png"}),Object(Y.a)(pe,"FRONT_RIGHT",{uri:"/assets/models/2D/furniture/furniture_front.svg",thumbnail:"/assets/models/3D/furniture/thumbnail.png"}),pe)),Ne=function(e){switch(e){case ve:return{width:.75,depth:.5,height:.75};case"FURNITURE":return{width:7,depth:1.5,height:2};default:return{width:1,depth:1,height:1}}},Ie=function(e){switch(e){case"KIOSK":return Te.KIOSK.thumbnail;case ve:return Te[ve].thumbnail;case"BOARD":return Te.BOARD.thumbnail;case"FURNITURE":return Te.FURNITURE.thumbnail;default:return Te[ve].thumbnail}},De=function e(){Object(O.a)(this,e)};De.createModel=function(e){var t=e.x,n=e.y,a=e.type,i=e.scene,o=e.onUpdate,r=e.onSuccess,c=e.onSelection,s=function(e,t){switch(e){case"FURNITURE":default:return ye.FURNITURE[t].uri}}(a,"TOP"),l=Ne(a),d=l.width,u=l.depth,m=je.calculate(i,d,u),h=m.width,E=m.height;he.a.Image.fromURL(s,(function(e){var s=i.containerWidth,l=i.containerHeight;e.setAttrs({x:t||s/2,y:n||l/2,type:a,width:h,height:E,offsetX:h/2,offsetY:E/2,draggable:"true",dragBoundFunc:function(e){return Oe.boundDetection(i,h,E,e)}}),fe.addModelBasicEventListeners(e,o,c),i.layer.add(e),r&&"function"===typeof r&&r(e),i.layer.batchDraw()}))};var Ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_WIDTH,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_HEIGHT,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(O.a)(this,e),this.objects=[],this.roomWidth=t,this.roomHeight=n,this.enablePlaneControls=a,this.domContainer=document.getElementById(e.DOM_CONTAINER_ID),this.containerWidth=this.domContainer.clientWidth,this.containerHeight=this.domContainer.clientHeight,this.containerAspectRatio=this.containerWidth/this.containerHeight,this.render=this.render.bind(this)}return Object(ue.a)(e,[{key:"init",value:function(){this.setInitialStage(),this.setInitialLayer(),this.setPlane(),this.addZoomEventToStage(),this.render()}},{key:"setInitialStage",value:function(){this.stage=new he.a.Stage({container:e.DOM_CONTAINER_ID,width:this.containerWidth,height:this.containerHeight,draggable:this.enablePlaneControls?"true":null})}},{key:"setInitialLayer",value:function(){this.layer=new he.a.Layer,this.addLayerToStage(this.layer),this.layer.draw()}},{key:"addLayerToStage",value:function(e){this.stage.add(e)}},{key:"addZoomEventToStage",value:function(){this.enablePlaneControls&&Ee.addPlaneZoomEventListener(this.stage)}},{key:"setPlaneCenter",value:function(){this.planeCenterCoordinates={x:this.containerWidth/2,y:this.containerHeight/2}}},{key:"setPlane",value:function(){this.plane=new he.a.Rect({x:0,y:0,width:this.containerWidth,height:this.containerHeight,fill:"lightgray",stroke:"black",opacity:.25,strokeWidth:1}),this.setPlaneCenter(),this.layer.add(this.plane),this.drawGrid(),this.drawRoom()}},{key:"drawGrid",value:function(){var e=this,t=this.containerHeight/50,n=this.containerWidth/50,a=function(t,n,a,i){Array.from(new Array(Math.round(t))).forEach((function(t,o){e.layer.add(new he.a.Rect({x:"ROW"===n?0:o*i,y:"ROW"===n?o*i:0,width:"ROW"===n?a:0,height:"ROW"===n?0:a,stroke:"black",opacity:.25,strokeWidth:1}))}))};a(t,"ROW",this.containerWidth,50),a(n,"COLUMN",this.containerHeight,50)}},{key:"drawRoom",value:function(){var e=this.roomWidth,t=this.roomHeight,n=this.containerWidth,a=this.containerHeight,i=new be(e,t,n,a);this.roomCoordinates=i.calculate(),this.roomDimensionInPixels=i.getRoomDimensionsInPixels();var o=this.roomCoordinates,r=o.initialX,c=o.initialY,s=this.roomDimensionInPixels,l=s.width,d=s.height;this.layer.add(new he.a.Rect({x:r,y:c,width:l,height:d,stroke:"black",opacity:1,strokeWidth:1}))}},{key:"getRoomDimensionInPixels",value:function(){return this.roomDimensionInPixels}},{key:"render",value:function(){requestAnimationFrame(this.render),this.stage.batchDraw()}},{key:"loadSVGModel",value:function(e,t,n,a,i){var o=t.x,r=t.y;De.createModel({x:o,y:r,type:e,scene:this,onUpdate:a,onSuccess:n,onSelection:i})}}]),e}();Ce.BIDIMENSIONAL_SCENE="2d",Ce.DOM_CONTAINER_ID="bidimensional_renderer",Ce.DEFAULT_WIDTH=5,Ce.DEFAULT_HEIGHT=5,Ce.PLANE_PADDING=10;var Re=function(){return i.a.createElement(de,{id:Ce.DOM_CONTAINER_ID,height:100})},xe=n(1),Se=n(42),_e=n(43),Pe=n(44),Ae=n(45),ke=function(){function e(t,n,a,i){Object(O.a)(this,e),this.object=t,this.planeWidth=a,this.planeHeight=i,this.initialYPosition=n,this.scaleInX=1,this.scaleInZ=1,this.positionX=0,this.positionZ=0,this.maxPointInX=0,this.maxPointInZ=0,this.minPointInX=0,this.minPointInZ=0}return Object(ue.a)(e,[{key:"setParametersFromObject",value:function(){var e=this.object,t=e.scale,n=t.x,a=t.z,i=e.position,o=i.x,r=i.z,c=e.geometry.boundingBox,s=c.max,l=s.x,d=s.z,u=c.min,m=u.x,h=u.z;this.scaleInX=n,this.scaleInZ=a,this.positionX=o,this.positionZ=r,this.maxPointInX=l,this.maxPointInZ=d,this.minPointInX=m,this.minPointInZ=h}},{key:"setObjectPositionX",value:function(e){this.object.position.x=e}},{key:"setObjectPositionY",value:function(e){this.object.position.y=e}},{key:"setObjectPositionZ",value:function(e){this.object.position.z=e}},{key:"setObjectPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e&&this.setObjectPositionX(e),t&&this.setObjectPositionY(t),n&&this.setObjectPositionZ(n)}},{key:"applyBoundDetectionAlgorithm",value:function(){this.setParametersFromObject(),this.setObjectPositionY(this.initialYPosition);var e=this.scaleInX,t=this.scaleInZ,n=this.positionX,a=this.positionZ,i=this.planeWidth,o=this.planeHeight,r=this.maxPointInX,c=this.maxPointInZ,s=i/2,l=o/2,d=(r-this.minPointInX)*e,u=(c-this.minPointInZ)*t,m=Math.abs(n)+d/2,h=Math.abs(a)+u/2;if(m>=s){var E=(s-d/2)*Math.sign(n);this.setObjectPositionX(E)}if(h>=l){var b=(l-u/2)*Math.sign(a);this.setObjectPositionZ(b)}}}]),e}(),we=function e(t,n,a,i){var o=this;Object(O.a)(this,e),this.setAttributesFromModel=function(){var e=o.model.geometry.boundingBox,t=e.max,n=e.min,a=t.x,i=t.y,r=t.z,c=n.x,s=n.y,l=n.z;o.maximumPointInX=a,o.maximumPointInY=i,o.maximumPointInZ=r,o.minimumPointInX=c,o.minimumPointInY=s,o.minimumPointInZ=l},this.calculateScale=function(){var e=o.modelWidth,t=o.modelDepth,n=o.modelHeight,a=o.maximumPointInX,i=o.maximumPointInY,r=o.maximumPointInZ;return{x:e/(a-o.minimumPointInX),y:n/(i-o.minimumPointInY),z:t/(r-o.minimumPointInZ)}},this.model=t,this.modelWidth=n,this.modelHeight=a,this.modelDepth=i,this.setAttributesFromModel()},We=function(){function e(){Object(O.a)(this,e)}return Object(ue.a)(e,null,[{key:"create",value:function(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_SIZE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.DEFAULT_SIZE;switch(t){case e.GRID:n=new xe.o(a,e.DEFAULT_GRID);break;case e.MESH_PLANE:new xe.rb;(n=new xe.K(new xe.Y(a,i,e.DEFAULT_GRID,e.DEFAULT_GRID),new xe.L({color:13882323}))).rotateX(-Math.PI/2),n.material.side=xe.k;break;default:n=new xe.o(e.DEFAULT_SIZE,e.DEFAULT_GRID)}return n}}]),e}();We.GRID="GRID",We.MESH_PLANE="MESH_PLANE",We.DEFAULT_SIZE=5,We.DEFAULT_GRID=100;var He=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We.DEFAULT_SIZE,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We.DEFAULT_SIZE;Object(O.a)(this,e),this.addTextureToObject=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.isMesh){var a=(new xe.rb).load(n||e.DEFAULT_TEXTURE_URI);a.encoding=xe.F,a.flipY=!1,t.material=new xe.M({map:a}),t.material.side=xe.k}},this.getOptimalCameraDistance=function(){return 1.15*Math.max(t.sceneHeight,t.sceneWidth)},this.objects=[],this.sceneWidth=n,this.sceneHeight=a,this.domContainer=document.getElementById(e.DOM_CONTAINER_ID),this.containerWidth=this.domContainer.clientWidth,this.containerHeight=this.domContainer.clientHeight,this.containerAspectRatio=this.containerWidth/this.containerHeight,this.plane=null,this.orbitControls=null,this.dragControls=null,this.enableOrbitControls=!0,this.render=this.render.bind(this)}return Object(ue.a)(e,[{key:"init",value:function(){this.setInitialScene(),this.setInitialCameraState(),this.setInitialRenderer(),this.addControls(),this.addPlane(),this.addResizeListener(),this.addInteractionEvents(),this.render()}},{key:"setInitialScene",value:function(){this.scene=new xe.jb,this.addLight()}},{key:"setInitialCameraState",value:function(){var e=this.getOptimalCameraDistance();this.camera=new xe.W(50,this.containerAspectRatio,.01,3e3),this.camera.position.set(0,e,0),this.camera.lookAt(0,e,0)}},{key:"setInitialRenderer",value:function(){this.renderer=new xe.xb({antialias:!0}),this.renderer.setClearColor("#e5e5e5"),this.renderer.setSize(this.containerWidth,this.containerHeight),this.domContainer.appendChild(this.renderer.domElement)}},{key:"addControls",value:function(){this.orbitControls=new Se.a(this.camera,this.renderer.domElement),this.dragControls=new _e.a(this.objects,this.camera,this.renderer.domElement),this.addControlsEventListeners()}},{key:"addControlsEventListeners",value:function(){var e=this,t=0;this.dragControls.addEventListener("dragstart",(function(n){t=n.object.position.y,e.orbitControls&&(e.orbitControls.enabled=!1)})),this.dragControls.addEventListener("drag",(function(n){var a=e.sceneHeight,i=e.sceneWidth;new ke(n.object,t,i,a).applyBoundDetectionAlgorithm()})),this.dragControls.addEventListener("dragend",(function(t){t.object.material.opacity=1,e.onDragEnd&&"function"===typeof e.onDragEnd&&e.onDragEnd(t),e.orbitControls&&(e.orbitControls.enabled=e.enableOrbitControls)}))}},{key:"addPlane",value:function(){var e=We.create(We.GRID,50);this.addToScene(e),this.plane=We.create(We.MESH_PLANE,this.sceneWidth,this.sceneHeight),this.addToScene(this.plane)}},{key:"addResizeListener",value:function(){var e=this;window.addEventListener("resize",(function(){e.setContainerDimensions(),e.renderer&&e.renderer.setSize(e.containerWidth,e.containerHeight),e.camera&&(e.camera.aspect=e.containerAspectRatio,e.camera.updateProjectionMatrix())}))}},{key:"addInteractionEvents",value:function(){this.interaction=new Ae.a(this.renderer,this.scene,this.camera)}},{key:"render",value:function(){requestAnimationFrame(this.render),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera),this.orbitControls&&this.orbitControls.update()}},{key:"setDragEndCallback",value:function(e){e&&"function"===typeof e&&(this.onDragEnd=e),this.onDragEnd=this.onDragEnd.bind(this)}},{key:"addToScene",value:function(e){this.scene.add(e)}},{key:"addLight",value:function(){var t=new xe.a(e.DEFAULT_LIGHT_COLOR,e.DEFAULT_LIGHT_INTENSITY);t.position.set(0,0,0),this.addToScene(t)}},{key:"setContainerDimensions",value:function(){this.containerWidth=this.domContainer.clientWidth,this.containerHeight=this.domContainer.clientHeight,this.containerAspectRatio=this.containerWidth/this.containerHeight}},{key:"addObject",value:function(e){this.objects.push(e)}},{key:"setObjects",value:function(e){Array.isArray(e)&&(this.objects=e)}},{key:"load3DModel",value:function(t,n,a,i){var o=this,r=n.x,c=void 0===r?0:r,s=n.y,l=void 0===s?0:s,d=n.z,u=void 0===d?0:d,m=function(e){switch(e){case"WALL":return"/assets/models/3D/wall.glb";case"KIOSK":return Te.KIOSK.uri;case ve:return Te[ve].uri;case"BOARD":return Te.BOARD.uri;case"FURNITURE":return Te.FURNITURE.uri;default:return Te.KIOSK.uri}}(t),h=Ne(t),E=h.width,b=h.height,f=h.depth;(new Pe.a).load(m,(function(t){t.scene.scale.set(1,1,1),t.scene.position.set(0,0,0),o.addToScene(t.scene),t.scene.traverse((function(t){if(t.isMesh){t.on("click",(function(e){e.data.originalEvent.detail>1&&i&&"function"===typeof i&&i(e)}));var n=new we(t,E,b,f).calculateScale(),r=n.x,s=n.y,d=n.z;t.scale.set(r,s,d);var m=o.getObjectYInitialPosition(l,t);t.position.set(c,m,u),t.material.map||o.addTextureToObject(t,e.DEFAULT_TEXTURE_URI),a&&"function"===typeof a&&a(t),o.addObject(t)}}))}))}},{key:"getObjectYInitialPosition",value:function(e,t){return e+Math.abs(t.geometry.boundingBox.min.y)*t.scale.y}},{key:"setOrbitControlsEnabled",value:function(e){this.enableOrbitControls=e,this.orbitControls.enabled=e}}]),e}();He.TRIDIMENSIONAL_SCENE="3d",He.DOM_CONTAINER_ID="tridimensional_renderer",He.DEFAULT_LIGHT_COLOR=16777215,He.DEFAULT_LIGHT_INTENSITY=1,He.DEFAULT_TEXTURE_URI="/assets/textures/wood.png";var Le=function e(t,n,a,i){var o=this;Object(O.a)(this,e),this.setParametersFromScene=function(){var e=Object(d.a)({},o.bidimensionalScene),t=e.roomWidth,n=e.roomHeight,a=e.sceneWidth,i=e.sceneHeight,r=Object(d.a)({},o.tridimensionalScene),c=r.sceneWidth,s=r.sceneHeight;o.bidimensionalRoomWidth=t,o.bidimensionalRoomHeight=n,o.bidimensionalSceneWidth=a,o.bidimensionalSceneHeight=i,o.tridimensionalSceneWidth=c,o.tridimensionalSceneHeight=s},this.originBidimensionalPlaneCoordinates=function(){var e=o.x,t=o.y;return{x:o.bidimensionalSceneWidth/2-e,y:o.bidimensionalSceneHeight/2-t}},this.bidimensionalToTridimensionalCoordinates=function(){var e=o.bidimensionalRoomWidth,t=o.bidimensionalRoomHeight,n=o.tridimensionalSceneWidth,a=o.tridimensionalSceneHeight,i=(0,o.originBidimensionalPlaneCoordinates)();return{x:-1*i.x*(n/e),y:0,z:-1*i.y*(a/t)}},this.originTridimensionalPlaneCoordinates=function(e,t){return{x:o.bidimensionalSceneWidth/2+e,y:o.bidimensionalSceneHeight/2+t}},this.tridimensionalToBidimensionalCoordinates=function(){var e=o.x,t=(o.y,o.z),n=o.bidimensionalRoomWidth,a=o.bidimensionalRoomHeight,i=o.tridimensionalSceneWidth,r=o.tridimensionalSceneHeight;return(0,o.originTridimensionalPlaneCoordinates)(e*(n/i),t*(a/r))},this.scene=t,this.bidimensionalScene=t[Ce.BIDIMENSIONAL_SCENE],this.tridimensionalScene=t[He.TRIDIMENSIONAL_SCENE],this.setParametersFromScene(),this.x=n,this.y=a,this.z=i},Fe=function(e){var t=ie((function(t){var n=Ce.BIDIMENSIONAL_SCENE,o=He.TRIDIMENSIONAL_SCENE,r=t.project,c=t.addObject,s=t.editorState,l=s.editorWidth,u=s.editorHeight,m=t.updateObject,h=(t.removeObject,t.set2DRoomDimensions),E=t.set2DSceneDimensions,b=Object(B.a)(t,["project","addObject","editorState","updateObject","removeObject","set2DRoomDimensions","set2DSceneDimensions"]),O=r.objects,g=Object(a.useState)({}),p=Object(f.a)(g,2),j=p[0],v=p[1],T=Object(a.useState)(),y=Object(f.a)(T,2),N=y[0],I=y[1],D=Object(a.useState)(),C=Object(f.a)(D,2),R=C[0],x=C[1];Object(a.useEffect)((function(){var e=new Ce(l,u);e.init(),I(e);var t=e.containerWidth,a=e.containerHeight;E(t,a);var i=e.getRoomDimensionInPixels(),o=i.width,r=i.height;h(o,r);!function(){var t=Object(d.a)({},j);O.forEach((function(a){var i=a.type,o=a[n].coordinates;t[i]?t[i].quantity++:t[i]={quantity:1},e.loadSVGModel(i,o,(function(e){var t=e._id,i=e.attrs,o=i.x,r=i.y,c=Object(d.a)(Object(d.a)({},a),{},Object(Y.a)({},n,{uuid:t,coordinates:{x:o,y:r}}));m(c)}),P)})),v(t)}()}),[]),Object(a.useEffect)((function(){var e;if(R){var t=R._id,a=R.x,i=R.y,r=_(t);if(r){var c=Object(d.a)({},r[o]),s=Object(d.a)(Object(d.a)({},r),{},(e={},Object(Y.a)(e,n,{uuid:t,coordinates:{x:a,y:i}}),Object(Y.a)(e,o,Object(d.a)(Object(d.a)({},c),{},{coordinates:k(a,i)})),e));m(s)}}}),[R]);var S=function(e){var t,a=e._id,i=e.attrs,r=i.x,s=i.y,l=i.type,d=(t={id:O.length,type:l},Object(Y.a)(t,n,{uuid:a,coordinates:{x:r,y:s}}),Object(Y.a)(t,o,{uuid:"",coordinates:{x:0,y:0,z:0}}),t);c(d)},_=function(e){return O.find((function(t){return t[n].uuid===e}))},P=function(e){if(e.target){var t=e.target,n=t._id,a=t.attrs,i=a.x,o=a.y;x({x:i,y:o,_id:n})}},A=function(e){var t=Object(d.a)({},j);t[e]?t[e].quantity++:t[e]={quantity:1},v(t)},k=function(e,t){var n=r.scene;return new Le(n,e,t).bidimensionalToTridimensionalCoordinates()};return i.a.createElement(e,Object.assign({models:j,addModel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};A(e),N.loadSVGModel(e,t,S,P)}},b))}));return K(t)},Ue=(n(96),function(e){var t=e.width,n=e.children,a=e.className,o=Object(B.a)(e,["width","children","className"]);return i.a.createElement("div",Object.assign({className:"w-".concat(t," ").concat(a||"")},o),n)}),Me=(n(97),function(e){var t=e.title,n=e.model,a=e.onClick,o=e.className,r=e.modelQuantity,c=e.imageClassName;return i.a.createElement("div",{title:t,onClick:a,className:"model-thumbnail-container cursor-click ".concat(o||""),"data-toggle":"tooltip","data-placement":"right"},i.a.createElement("img",{src:Ie(n),alt:n,className:c||"model-thumbnail"}),r>0&&i.a.createElement("div",{className:"quantity-tile"},i.a.createElement("span",{className:"rounded-circle bg-primary circle-tile text-light"},r)))}),Be=function(e){var t=e.models,n=e.addModel,a=e.className;return i.a.createElement(X,{className:"justify-content-start pt-2 ".concat(a||"")},i.a.createElement(Me,{model:"TABLE",title:"Mesa",onClick:function(e){return n("TABLE")},className:"mr-3",modelQuantity:t.TABLE?t.TABLE.quantity:0}),i.a.createElement(Me,{model:"KIOSK",title:"Kiosko",onClick:function(e){return n("KIOSK")},className:"mr-3",modelQuantity:t.KIOSK?t.KIOSK.quantity:0}),i.a.createElement(Me,{model:"BOARD",title:"Pizarr\xf3n",onClick:function(e){return n("BOARD")},className:"mr-3",modelQuantity:t.BOARD?t.BOARD.quantity:0}),i.a.createElement(Me,{model:"FURNITURE",title:"Entrepa\xf1os",onClick:function(e){return n("FURNITURE")},className:"mr-3",modelQuantity:t.FURNITURE?t.FURNITURE.quantity:0}))},Ge=function(e){var t=e.models,n=e.addModel;return i.a.createElement(X,null,i.a.createElement(Ue,{width:75,className:"overflow-auto h-100"},i.a.createElement(Be,{models:t,addModel:n})))},Xe=Fe((function(e){var t=e.models,n=e.addModel;return i.a.createElement(de,{height:100},i.a.createElement(de,{height:90},i.a.createElement(Re,null)),i.a.createElement(de,{height:10,className:"bg-none"},i.a.createElement(Ge,{models:t,addModel:n})))})),ze=function e(){Object(O.a)(this,e)};ze.WOOD_TEXTURE="WOOD_TEXTURE",ze.FLOOR_TEXTURE="FLOOR_TEXTURE",ze.getTextureUri=function(e){switch(e){case ze.WOOD_TEXTURE:return"/assets/textures/wood.png";case ze.FLOOR_TEXTURE:default:return"/assets/textures/floor.png"}};var Ve=function(e){var t=e.editorWidth,n=e.editorHeight,a=e.setEditorHeight,o=e.setEditorWidth,r=e.handleTextureChange;return i.a.createElement("div",{className:"dropup",title:"Ajustes de escena 3D","data-toggle":"tooltip","data-placement":"top"},i.a.createElement("div",{className:"dropdown"},i.a.createElement(Q,{id:"3d_scene_settings",icon:q.j,type:"outline-secondary",className:"rounded-pill pr-1 py-2 mr-2","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),i.a.createElement("div",{className:"dropdown-menu mb-5 px-3 oveflow-auto","aria-labelledby":"3d_scene_settings"},i.a.createElement("h5",null,"Plane"),i.a.createElement("div",{className:"form-group"},i.a.createElement("h6",null,"Dimensiones: "),i.a.createElement("label",null,"Alto: "),i.a.createElement("input",{type:"text",value:n,onChange:function(e){return a(e.target.value)},className:"form-control"}),i.a.createElement("label",null,"Ancho: "),i.a.createElement("input",{type:"text",value:t,onChange:function(e){return o(e.target.value)},className:"form-control"})),i.a.createElement("div",{className:"form-group"},i.a.createElement("h6",null,"Textura:"),i.a.createElement("div",null,i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:ze.FLOOR_TEXTURE,onChange:r,className:"mr-2"}),i.a.createElement("img",{src:ze.getTextureUri(ze.FLOOR_TEXTURE),width:"30px",height:"30px",className:"mr-2"}),"Piso")),i.a.createElement("div",{className:"mt-2"},i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",value:ze.WOOD_TEXTURE,onChange:r,className:"mr-2"}),i.a.createElement("img",{src:ze.getTextureUri(ze.WOOD_TEXTURE),width:"30px",height:"30px",className:"mr-2"}),"Duela"))))))},Ze=function e(){Object(O.a)(this,e)};Ze.TOP_VIEW="TOP_VIEW",Ze.BACK_VIEW="BACK_VIEW",Ze.FRONT_VIEW="FRONT_VIEW",Ze.FRONT_LEFT="FRONT_LEFT",Ze.FRONT_RIGHT="FRONT_RIGHT",Ze.ISOMETRIC_VIEW="ISOMETRIC_VIEW",Ze.createCameraRotationVector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t||He.DEFAULT_CAMERA_DISTANCE,a=new xe.vb(0,0,0),i=Ze.TOP_VIEW,o=Ze.BACK_VIEW,r=Ze.FRONT_VIEW,c=Ze.FRONT_LEFT,s=Ze.FRONT_RIGHT,l=Ze.ISOMETRIC_VIEW;switch(e){case i:a.setY(n);break;case o:a.setZ(-n);break;case r:a.setZ(n);break;case c:a.setX(-n);break;case s:a.setX(n);break;case l:n-=2,a.setX(n),a.setY(n/2),a.setZ(n);break;default:a.setY(n)}return a};var Ke,qe=function(e){var t=e.rotateCamera,n=Ze.TOP_VIEW,a=Ze.BACK_VIEW,o=Ze.FRONT_VIEW,r=Ze.FRONT_LEFT,c=Ze.FRONT_RIGHT,s=Ze.ISOMETRIC_VIEW;return i.a.createElement("div",{title:"Vistas",className:"dropup","data-toggle":"tooltip","data-placement":"top"},i.a.createElement(Z,{icon:q.m,title:"Vistas",className:"cursor-click mb-0 btn btn-outline-secondary rounded-pill pr-1 mr-2 py-2","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}),i.a.createElement("div",{className:"dropdown-menu mb-3 px-2 py-2"},i.a.createElement(z,null,i.a.createElement(Z,{icon:q.i,labelText:"Superior",onClick:function(e){return t(n)},className:"cursor-click dropdown-item"}),i.a.createElement(Z,{icon:q.x,labelText:"Frente",onClick:function(e){return t(o)},className:"cursor-click dropdown-item"}),i.a.createElement(Z,{icon:q.y,labelText:"Atras",onClick:function(e){return t(a)},className:"cursor-click dropdown-item"}),i.a.createElement(Z,{icon:q.h,labelText:"Derecha",onClick:function(e){return t(c)},className:"cursor-click dropdown-item"}),i.a.createElement(Z,{icon:q.g,labelText:"Izquierda",onClick:function(e){return t(r)},className:"cursor-click dropdown-item"}),i.a.createElement(Z,{icon:q.n,labelText:"Isom\xe9trico",onClick:function(e){return t(s)},className:"cursor-click dropdown-item"}))))},Ye=ie((function(e){var t=e.editorState,n=e.setEditorWidth,a=e.setEditorHeight,o=e.rotateCamera,r=e.addTextureToPlane,c=e.toggleOrbitControls,s=e.orbitControlsEnabled,l=t.editorHeight,d=t.editorWidth;return i.a.createElement(X,{className:"justify-content-start align-items-center"},i.a.createElement(qe,{rotateCamera:o}),i.a.createElement(Ve,{editorWidth:d,editorHeight:l,setEditorWidth:n,setEditorHeight:a,handleTextureChange:function(e){var t=e.target,n=t.checked,a=t.value;n&&r(a)}}),i.a.createElement(Q,{icon:s?q.q:q.r,title:"Bloquear/desbloquear plano",type:s?"outline-secondary":"secondary",onClick:c,className:"btn-sm rounded-pill px-3 py-2 mr-2",buttonText:i.a.createElement(V.a,{icon:q.b}),"data-toggle":"tooltip","data-placement":"top"}))})),Je=K(Ye),Qe=function(e){var t=e.models,n=e.addModel,a=e.rotateCamera,o=e.addTextureToPlane,r=e.toggleOrbitControls,c=e.orbitControlsEnabled;return i.a.createElement(X,{className:"justify-content-around align-items-center"},i.a.createElement(Ue,{width:75,className:"overflow-auto h-100"},i.a.createElement(Be,{models:t,addModel:n})),i.a.createElement(Ue,{width:25},i.a.createElement(Je,{rotateCamera:a,addTextureToPlane:o,toggleOrbitControls:r,orbitControlsEnabled:c})))},$e=function(){return i.a.createElement(de,{id:"tridimensional_renderer",height:100})},et=function(e){var t=ie((function(t){var n=t.project,o=t.addObject,r=t.editorState,c=r.editorWidth,s=r.editorHeight,l=t.updateObject,u=(t.removeObject,t.set2DSceneDimensions,t.set3DSceneDimensions,Object(B.a)(t,["project","addObject","editorState","updateObject","removeObject","set2DSceneDimensions","set3DSceneDimensions"])),m=n.objects,h=Object(a.useState)({}),E=Object(f.a)(h,2),b=E[0],O=E[1],g=Object(a.useState)(),p=Object(f.a)(g,2),j=p[0],v=p[1],T=Object(a.useState)(),y=Object(f.a)(T,2),N=y[0],I=y[1],D=Object(a.useState)(!0),C=Object(f.a)(D,2),R=C[0],x=C[1];Object(a.useEffect)((function(){var e=new He(c,s);e.init(),e.setDragEndCallback(_),v(e);!function(){var t=Object(d.a)({},b);m.forEach((function(n){var a=n.type,i=n["3d"].coordinates;t[a]?t[a].quantity++:t[a]={quantity:1},e.load3DModel(a,i,(function(e){var t=e.uuid,a=Object(d.a)(Object(d.a)({},n),{},{"3d":{uuid:t,container:S(e),coordinates:i}});l(a)}),_)})),O(t)}(),e=null}),[]),Object(a.useEffect)((function(){if(N){var e=N.uuid,t=N.x,n=N.y,a=N.z,i=P(e);if(i){var o=Object(d.a)({},i["2d"]),r=Object(d.a)({},i["3d"]),c=Object(d.a)(Object(d.a)({},i),{},{"2d":Object(d.a)(Object(d.a)({},o),{},{coordinates:A(t,n,a)}),"3d":Object(d.a)(Object(d.a)({},r),{},{uuid:e,coordinates:{x:t,y:0,z:a}})});l(c)}else console.log("Objeto no encontrado")}}),[N]),Object(a.useEffect)((function(){j&&j.setOrbitControlsEnabled(R)}),[R]);var S=function(e){var t=e.scale,n=t.x,a=t.z,i=e.geometry.boundingBox,o=i.min,r=o.x,c=o.z,s=i.max,l=s.x;return{itemDepth:(s.z-c)*a,itemWidth:(l-r)*n}},_=function(e){var t=e.object,n=t.position,a=n.x,i=n.y,o=n.z,r=t.uuid;I({x:a,y:i,z:o,uuid:r})},P=function(e){return m.find((function(t){return t["3d"].uuid===e}))},A=function(e,t,a){var i=n.scene;return new Le(i,e,t,a).tridimensionalToBidimensionalCoordinates()},k=function(e){var t=Object(d.a)({},b);t[e]?t[e].quantity++:t[e]={quantity:1},O(t)};return i.a.createElement(e,Object.assign({models:b,addModel:function(e){k(e),j.load3DModel(e,{x:0,y:0,z:0},(function(t){return function(e,t){var n=e.uuid,a=e.position,i=a.x,r=a.y,c=a.z,s={id:m.length,type:t,"2d":{uuid:"",coordinates:A(i,r,c)},"3d":{uuid:n,container:S(e),coordinates:{x:i,y:0,z:c}}};o(s)}(t,e)}))},rotateCamera:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze.TOP_VIEW,t=j.getOptimalCameraDistance(),n=Ze.createCameraRotationVector(e,t);j.camera.position.copy(n)},addTextureToPlane:function(e){var t=ze.getTextureUri(e);j.addTextureToObject(j.plane,t)},addTextureToObject:function(e,t){return j.addTextureToObject(e,t)},toggleOrbitControls:function(){x(!R)},orbitControlsEnabled:R},u))}));return K(t)}((function(e){var t=e.models,n=e.addModel,a=e.rotateCamera,o=e.addTextureToPlane,r=e.toggleOrbitControls,c=e.orbitControlsEnabled;return i.a.createElement(de,{height:100},i.a.createElement(de,{height:90},i.a.createElement($e,null)),i.a.createElement(de,{height:10},i.a.createElement(Qe,{models:t,addModel:n,rotateCamera:a,addTextureToPlane:o,toggleOrbitControls:r,orbitControlsEnabled:c})))})),tt=[{model_id:"FURNITURE",name:"Entrepa\xf1os",description:"Conjunto de entrepa\xf1os de distintos tama\xf1os y con m\xfaltiples cajones."},{model_id:ve,name:"Mesa",description:"Mesa de madera de 1m x 1m."}],nt=(n(98),ie((function(e){var t=e.project,n=e.addObject,o=t.objects,r=Object(a.useState)({}),c=Object(f.a)(r,2),s=c[0],l=c[1];Object(a.useEffect)((function(){var e=Object(d.a)({},s);o.forEach((function(t){var n=t.type;e[n]?e[n].quantity++:e[n]={quantity:1}})),l(e)}),[]);return i.a.createElement(G,{className:"justify-content-around align-items-between flex-wrap"},tt.map((function(e){return i.a.createElement("div",{className:"card rounded-lg border-muted catalog-tile mt-3"},i.a.createElement("div",{className:"card-body px-2 py-2"},i.a.createElement("table",{className:"table table-sm table-borderless"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"2"},i.a.createElement(Me,{model:e.model_id,title:e.name,className:"mr-3 mt-3",modelQuantity:s[e.model_id]?s[e.model_id].quantity:0,imageClassName:"catalog-thumbnail"})))),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Nombre"),i.a.createElement("td",null,e.name)),i.a.createElement("tr",null,i.a.createElement("th",null,"Descripci\xf3n"),i.a.createElement("td",null,e.description)),i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"2"},i.a.createElement(Q,{id:e.model_id,icon:q.t,onClick:function(t){return function(e){var t={id:o.length,type:e,"2d":{uuid:"",coordinates:{x:0,y:0}},"3d":{uuid:"",coordinates:{x:0,y:0,z:0}}};n(t);var a=Object(d.a)({},s);a[e]?a[e].quantity++:a[e]={quantity:1},l(a)}(e.model_id)},className:"btn btn-primary rounded-lg shadow",buttonText:"Agregar"})))))))})))}))),at=function(){return i.a.createElement("div",{className:"container mt-3 text-center"},i.a.createElement(Z,{icon:q.f,className:"text-muted h4",labelText:"Cat\xe1logo de productos"}),i.a.createElement(nt,{models:{}}))},it=(Ke={},Object(Y.a)(Ke,"CATALOG",i.a.createElement(at,null)),Object(Y.a)(Ke,"PROJECT_SETTINGS",i.a.createElement(le,null)),Object(Y.a)(Ke,"BIDIMENSIONAL EDITOR",i.a.createElement(Xe,null)),Object(Y.a)(Ke,"TRIDIMENSIONAL_EDITOR",i.a.createElement(et,null)),Ke),ot=K((function(e){var t=e.setEditorType;return i.a.createElement(z,{className:"align-items-center justify-content-around"},i.a.createElement(Z,{icon:q.w,title:"Cat\xe1logo",onClick:function(e){return t("CATALOG")},className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}),i.a.createElement(Z,{icon:q.n,title:"3D",onClick:function(e){return t("TRIDIMENSIONAL_EDITOR")},className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}),i.a.createElement(Z,{icon:q.s,title:"2D",onClick:function(e){return t("BIDIMENSIONAL EDITOR")},className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}),i.a.createElement(Z,{icon:q.j,title:"Ajustes del proyecto",onClick:function(e){return t("PROJECT_SETTINGS")},className:"text-sidebar-icon cursor-click","data-toggle":"tooltip","data-placement":"right"}))})),rt=function(e){var t=e.className;return i.a.createElement(z,{className:"align-items-center justify-content-around ".concat(t||"")},i.a.createElement(Z,{icon:q.v,title:"Guardar",className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}),i.a.createElement(Z,{icon:q.p,title:"Abrir",className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}),i.a.createElement(Z,{icon:q.o,title:"Descargar",className:"text-sidebar-icon cursor-click mb-3","data-toggle":"tooltip","data-placement":"right"}))},ct=(n(99),function(){return i.a.createElement(Ue,{width:5,className:"position-relative"},i.a.createElement(de,{height:100,className:"sidebar-width position-fixed bg-dark pt-4"},i.a.createElement(z,{className:"align-items-center justify-content-start"},i.a.createElement(rt,{className:"my-4"}),i.a.createElement(ot,null))))}),st=K((function(e){var t=e.editorState,n=t.editorType,a=t.editorWidth,o=t.editorHeight;return a&&o?it[n]:i.a.createElement(le,null)})),lt=function(){return Object(a.useEffect)((function(){M()((function(){return M()('[data-toggle="tooltip"]').tooltip()}))}),[]),i.a.createElement(a.Fragment,null,i.a.createElement(X,{className:"w-100 h-100"},i.a.createElement(ct,null),i.a.createElement(Ue,{width:95},i.a.createElement(st,null))))};n(100),n(101),n(102),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var dt=F(),ut=i.a.createElement(c.a,{store:dt},i.a.createElement(lt,null));r.a.render(ut,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},46:function(e,t,n){e.exports=n(103)},58:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[46,1,2]]]);
//# sourceMappingURL=main.a3d25265.chunk.js.map